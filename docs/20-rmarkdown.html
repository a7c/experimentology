<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 20 R Markdown Tutorial | Experimentology" />
<meta property="og:type" content="book" />





<meta name="author" content="Michael C. Frank, Mika Braginsky, Julie Cachia, Nicholas Coles, Tom Hardwicke, Robert Hawkins, Maya Mathur, and Rondeline Williams" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 20 R Markdown Tutorial | Experimentology">

<title>Chapter 20 R Markdown Tutorial | Experimentology</title>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="toc/toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li><a href="1-intro.html#intro"><span class="toc-section-number">1</span> Experiments and theories</a></li>
<li><a href="2-replication.html#replication"><span class="toc-section-number">2</span> Replication and reproducibility</a></li>
<li><a href="3-ethics.html#ethics"><span class="toc-section-number">3</span> Ethics</a></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li><a href="4-estimation.html#estimation"><span class="toc-section-number">4</span> Estimation</a></li>
<li><a href="5-inference.html#inference"><span class="toc-section-number">5</span> Inference</a></li>
<li><a href="6-models.html#models"><span class="toc-section-number">6</span> Models</a></li>
<li class="part"><span><b>III Design and Planning</b></span></li>
<li><a href="7-measurement.html#measurement"><span class="toc-section-number">7</span> Measurement</a></li>
<li><a href="8-design.html#design"><span class="toc-section-number">8</span> Design of experiments</a></li>
<li><a href="9-sampling.html#sampling"><span class="toc-section-number">9</span> Sampling</a></li>
<li><a href="10-prereg.html#prereg"><span class="toc-section-number">10</span> Preregistration</a></li>
<li class="part"><span><b>IV Execution</b></span></li>
<li><a href="11-selection.html#selection"><span class="toc-section-number">11</span> Replicating or extending an existing study</a></li>
<li><a href="12-collection.html#collection"><span class="toc-section-number">12</span> Data collection</a></li>
<li><a href="13-management.html#management"><span class="toc-section-number">13</span> Project management and sharing</a></li>
<li class="part"><span><b>V Analysis and Reporting</b></span></li>
<li><a href="14-viz.html#viz"><span class="toc-section-number">14</span> Visualization</a></li>
<li><a href="15-eda.html#eda"><span class="toc-section-number">15</span> Exploratory data analysis</a></li>
<li><a href="16-writing.html#writing"><span class="toc-section-number">16</span> Reproducible writing</a></li>
<li><a href="17-meta.html#meta"><span class="toc-section-number">17</span> Meta-analysis</a></li>
<li><a href="18-conclusions.html#conclusions"><span class="toc-section-number">18</span> Conclusions</a></li>
<li class="part"><span><b>VI Appendices</b></span></li>
<li><a href="19-github.html#github"><span class="toc-section-number">19</span> Github Tutorial</a></li>
<li><a href="20-rmarkdown.html#rmarkdown"><span class="toc-section-number">20</span> R Markdown Tutorial</a></li>
<li><a href="21-tidyverse.html#tidyverse"><span class="toc-section-number">21</span> Tidyverse Tutorial</a></li>
<li><a href="22-ggplot.html#ggplot"><span class="toc-section-number">22</span> ggplot Tutorial</a></li>
<li><a href="23-instructors.html#instructors"><span class="toc-section-number">23</span> Instructor’s Guide</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="rmarkdown" class="section level1" number="20">
<h1><span class="header-section-number">Chapter 20</span> R Markdown Tutorial</h1>
<div id="introduction-3" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Introduction</h2>
<p>This is a short tutorial on using RMarkdown to mix prose and code together for creating reproducible scientific documents. If you find any errors and have a Github account, <strong><a href="https://github.com/mcfrank/openscience_tutorial">please suggest changes here</a></strong>. This is adapted from <a href="https://github.com/mcfrank/rmarkdown-workshop">a slightly longer tutorial that Mike and Chris Hartgerink taught together at SIPS 2017</a>.</p>
<p>In short: RMarkdown allows you to create documents that are compiled with code, producing your next scientific paper.</p>
<p>Now we’re together trying to help spread the word, because it can make writing manuscripts so much easier! We wrote this handout in RMarkdown as well. <a href="https://github.com/mcfrank/openscience_tutorial/blob/master/rmarkdown_handout.Rmd">Take a look at the source.</a></p>
<div id="who-is-this-aimed-at" class="section level3" number="20.1.1">
<h3><span class="header-section-number">20.1.1</span> Who is this aimed at?</h3>
<p>We aim this document at anyone writing manuscripts and using R, including those who…</p>
<ol style="list-style-type: decimal">
<li>…collaborate with people who use Word</li>
<li>…want to write complex equations</li>
<li>…want to be able to change bibliography styles with less hassle</li>
<li>…want to spend more time actually doing research!</li>
</ol>
</div>
<div id="why-write-reproducible-papers" class="section level3" number="20.1.2">
<h3><span class="header-section-number">20.1.2</span> Why write reproducible papers?</h3>
<p>Cool, thanks for sticking with us and reading up through here!</p>
<p>There are three reasons to write reproducible papers. To be right, to be reproducible, and to be efficient. There are more, but these are convincing to us. In more depth:</p>
<ol style="list-style-type: decimal">
<li><p>To avoid errors. Using an automated method for scraping APA-formatted stats out of PDFs, <span class="citation"><a href="#ref-nuijten2016" role="doc-biblioref">Michèle B. Nuijten et al.</a> (<a href="#ref-nuijten2016" role="doc-biblioref">2016</a>)</span> found that over 10% of p-values in published papers were inconsistent with the reported details of the statistical test, and 1.6% were what they called “grossly” inconsistent, e.g. difference between the p-value and the test statistic meant that one implied statistical significance and the other did not. Nearly half of all papers had errors in them.</p></li>
<li><p>To promote computational reproducibility. Computational reproducibility means that other people can take your data and get the same numbers that are in your paper. Even if you don’t have errors, it can still be very hard to recover the numbers from published papers because of ambiguities in analysis. Creating a document that literally specifies where all the numbers come from in terms of code that operates over the data removes all this ambiguity.</p></li>
<li><p>To create spiffy documents that can be revised easily. This is actually a really big neglected one for us. At least one of us used to tweak tables and figures by hand constantly, leading to a major incentive <em>never to rerun analyses</em> because it would mean re-pasting and re-illustratoring all the numbers and figures in a paper. That’s a bad thing! It means you have an incentive to be lazy and to avoid redoing your stuff. And you waste tons of time when you do. In contrast, with a reproducible document, you can just rerun with a tweak to the code. You can even specify what you want the figures and tables to look like before you’re done with all the data collection (e.g., for purposes of preregistraion or a registered report).</p></li>
</ol>
</div>
<div id="learning-goals" class="section level3" number="20.1.3">
<h3><span class="header-section-number">20.1.3</span> Learning goals</h3>
<p>By the end of this class you should:</p>
<ul>
<li>Know what Markdown is and how the syntax works,</li>
<li>See how to integrate code and data in RMarkdown,</li>
<li>Understand the different output formats from RMarkdown and how to generate them, and</li>
<li>Know about generating APA format files with <code>papaja</code> and bibtex.</li>
</ul>
</div>
</div>
<div id="getting-started" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Getting Started</h2>
<p>Fire up Rstudio and create a new RMarkdown file. Don’t worry about the settings, we’ll get to that later.</p>
<p>If you click on “Knit” (or hit <code>CTRL+SHIFT+K</code>) the RMarkdown file will run and generate all results and present you with a PDF file, HTML file, or a Word file. If RStudio requests you to install packages, click yes and see whether everything works to begin with.</p>
<p>We need that before we teach you more about RMarkdown. But you should feel good if you get here already, because honestly, you’re about 80% of the way to being able to write basic RMarkdown files. It’s <em>that</em> easy.</p>
</div>
<div id="structure-of-an-rmarkdown-file" class="section level2" number="20.3">
<h2><span class="header-section-number">20.3</span> Structure of an RMarkdown file</h2>
<p>An RMarkdown file contains several parts. Most essential are the header, the body text, and code chunks.</p>
<div id="header" class="section level3" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Header</h3>
<p>Headers in RMarkdown files contain some metadata about your document, which you can customize to your liking. Below is a simple example that purely states the title, author name(s), date, and output format.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="20-rmarkdown.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb4-2"><a href="20-rmarkdown.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Untitled&quot;</span></span>
<span id="cb4-3"><a href="20-rmarkdown.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;NAME&quot;</span></span>
<span id="cb4-4"><a href="20-rmarkdown.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;July 28, 2017&quot;</span></span>
<span id="cb4-5"><a href="20-rmarkdown.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb4-6"><a href="20-rmarkdown.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<blockquote>
<p>ProTip: The header is written in “YAML,” which means “yet another markup language.” You don’t need to know that, and don’t worry about it. Just make sure you are careful with indenting, as YAML does care about that.</p>
</blockquote>
<p>For now, go ahead and set <code>html_document</code> to <code>word_document</code>, except if you have strong preferences for <code>HTML</code> or <code>PDF</code>.<label for="tufte-sn-134" class="margin-toggle sidenote-number">134</label><input type="checkbox" id="tufte-sn-134" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">134</span> Note: to create PDF documents you also need a TeX installation. Don’t know what that is? You probably don’t have it then. More info below.</span></p>
</div>
<div id="body-text" class="section level3" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Body text</h3>
<p>The body of the document is where you actually write your reports. This is primarily written in the Markdown format, which is explained in the <a href="20-rmarkdown.html#markdown-syntax">Markdown syntax</a> section.</p>
<p>The beauty of RMarkdown is, however, that you can evaluate <code>R</code> code right in the text. To do this, you start inline code with `r, type the code you want to run, and close it again with a `. Usually, this key is below the escape (<code>ESC</code>) key or next to the left SHIFT button.</p>
<p>For example, if you want to have the result of 48 times 35 in your text, you type ` r 48-35`, which returns 13. Please note that if you return a value with many decimals, it will also print these depending on your settings (for example, 3.1415927).</p>
</div>
<div id="code-chunks" class="section level3" number="20.3.3">
<h3><span class="header-section-number">20.3.3</span> Code chunks</h3>
<p>In the section above we introduced you to running code inside text, but often you need to take several steps in order to get to the result you need. And you don’t want to do data cleaning in the text! This is why there are code chunks. A simple example is a code chunk loading packages.</p>
<p>First, insert a code chunk by going to <code>Code-&gt;Insert code chunk</code> or by pressing <code>CTRL+ALT+I</code>. Inside this code chunk you can then type for example, <code>library(ggplot2)</code> and create an object <code>x</code>.</p>
<p>If you do not want to have the contents of the code chunk to be put into your document, you include <code>echo=FALSE</code> at the start of the code chunk. We can now use the contents from the above code chunk to print results (e.g., <span class="math inline">\(x=2\)</span>).</p>
<p>These code chunks can contain whatever you need, including tables, and figures (which we will go into more later). Note that all code chunks regard the location of the RMarkdown as the working directory, so when you try to read in data use the relative path in.</p>
</div>
</div>
<div id="markdown-syntax" class="section level2" number="20.4">
<h2><span class="header-section-number">20.4</span> Markdown syntax</h2>
<p>Markdown is one of the simplest document languages around, that is an open standard and can be converted into <code>.tex</code>, <code>.docx</code>, <code>.html</code>, <code>.pdf</code>, etc. This is the main workhorse of RMarkdown and is very powerful. You can <a href="https://learnxinyminutes.com/docs/markdown/">learn Markdown in five (!) minutes</a> Other resources include <a href="">http://rmarkdown.rstudio.com/authoring_basics.html</a>, and <a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf">this cheat sheet</a>.</p>
<p>You can do some pretty cool tricks with Markdown, but these are the basics:</p>
<ul>
<li>It’s easy to get <code>*italic*</code> or <code>**bold**</code>.</li>
<li>You can get headings using <code># heading1</code> for first level, <code>## heading2</code> for second-level, and <code>### heading3</code> for third level. Make sure you leave a space after the <code>#</code>!</li>
<li>Lists are delimited with <code>*</code> for each entry.</li>
<li>You can write links by writing <code>[here's my link](http://foo.com)</code>.</li>
</ul>
<p>If you want a more extensive description of all the potential of Markdown, <a href="https://daringfireball.net/projects/markdown/">this introduction to Markdown</a> is highly detailed.</p>
<p>The great thing about Markdown is that it works almost everywhere! Github, OSF, slack, many wikis, and even in text documents it looks pretty good. I find myself writing emails in markdown just because it’s a clear and consistent way to format and outline.</p>
<div id="exercises" class="section level3" number="20.4.1">
<h3><span class="header-section-number">20.4.1</span> Exercises</h3>
<p>Swap over to your new sample markdown.</p>
<ol style="list-style-type: decimal">
<li>Outlining using headings is a really great way to keep things organized! Try making a bunch of headings, and then recompiling your document.</li>
<li>Add a table of contents. This will involve going to the header of the document (the <code>YAML</code>), and adding some options to the <code>html document</code> bit. You want it to look like this (indentation must to be correct):</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="20-rmarkdown.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb5-2"><a href="20-rmarkdown.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="20-rmarkdown.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<p>Now recompile. Looks nice, right?<label for="tufte-sn-135" class="margin-toggle sidenote-number">135</label><input type="checkbox" id="tufte-sn-135" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">135</span> Pro-tip: you can specify how deep the TOC should go by adding <code>toc_depth: 2</code> to go two levels deep</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Try adding another option: <code>toc_float: true</code>. Recompile – super cool. There are plenty more great output options that you can modify. <a href="http://rmarkdown.rstudio.com/html_document_format.html">Here is a link to the documentation.</a></li>
</ol>
</div>
</div>
<div id="headers-tables-and-graphs" class="section level2" number="20.5">
<h2><span class="header-section-number">20.5</span> Headers, Tables, and Graphs</h2>
<div id="headers" class="section level3" number="20.5.1">
<h3><span class="header-section-number">20.5.1</span> Headers</h3>
<p>We’re going to want more libraries loaded (for now we’re loading them inline).</p>
<p>We often also add <code>chunk options</code> to each code chunk so that, for example:</p>
<ul>
<li>code does or doesn’t display inline (<code>echo</code> setting)</li>
<li>figures are shown at various sizes (<code>fig.width</code> and <code>fig.height</code> settings)</li>
<li>warnings and messages are suppressed (<code>warning</code> and <code>message</code> settings)</li>
<li>computations are cached (<code>cache</code> setting)</li>
</ul>
<p>There are many others available as well. Caching can be very helpful for large files, but can also cause problems when there are external dependencies that change. An example that is useful for manuscripts is:</p>
</div>
<div id="graphs" class="section level3" number="20.5.2">
<h3><span class="header-section-number">20.5.2</span> Graphs</h3>
<p>It’s really easy to include graphs, like this one. (Using the <code>mtcars</code> dataset that comes with <code>ggplot2</code>).</p>
<p><img src="experimentology_files/figure-html/unnamed-chunk-40-1.png" width="\linewidth"  /></p>
<p>All you have to do is make the plot and it will render straight into the text.</p>
<p>External graphics can also be included, as follows:</p>
</div>
<div id="tables" class="section level3" number="20.5.3">
<h3><span class="header-section-number">20.5.3</span> Tables</h3>
<p>There are many ways to make good-looking tables using RMarkdown, depending on your display purpose.</p>
<ul>
<li><p>The <code>knitr</code> package (which powers RMarkdown) comes with the <code>kable</code> function. It’s versatile and makes perfectly reasonable tables. It also has a <code>digits</code> argument for controlling rounding.</p></li>
<li><p>For HTML tables, there is the <code>DT</code> package, which provides <code>datatable</code> – these are pretty and interactive javascript-based tables that you can click on and search in. Not great for static documents though.</p></li>
<li><p>For APA manuscripts, it can also be helpful to use the <code>xtable</code> package, which creates very flexible LaTeX tables. These can be tricky to get right but they are completely customizable provided you want to google around and learn a bit about tex.</p></li>
</ul>
<p>We recommend starting with <code>kable</code>:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.9</td>
<td align="right">2.6</td>
<td align="right">16.5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.9</td>
<td align="right">2.9</td>
<td align="right">17.0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.9</td>
<td align="right">2.3</td>
<td align="right">18.6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.1</td>
<td align="right">3.2</td>
<td align="right">19.4</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.1</td>
<td align="right">3.4</td>
<td align="right">17.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.8</td>
<td align="right">3.5</td>
<td align="right">20.2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="statistics" class="section level3" number="20.5.4">
<h3><span class="header-section-number">20.5.4</span> Statistics</h3>
<p>It’s also really easy to include statistical tests of various types.</p>
<p>For this, an option is the <code>broom</code> package, which formats the outputs of various tests really nicely. Paired with knitr’s <code>kable</code> you can make very simple tables in just a few lines of code.</p>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">36.908</td>
<td align="right">2.191</td>
<td align="right">16.847</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">hp</td>
<td align="right">-0.019</td>
<td align="right">0.015</td>
<td align="right">-1.275</td>
<td align="right">0.213</td>
</tr>
<tr class="odd">
<td align="left">cyl</td>
<td align="right">-2.265</td>
<td align="right">0.576</td>
<td align="right">-3.933</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p>Of course, cleaning these up can take some work. For example, we’d need to rename a bunch of fields to make this table have the labels we wanted (e.g., to turn <code>hp</code> into <code>Horsepower</code>).</p>
<p>We often need APA-formatted statistics. We can compute them first, and then print them inline.</p>
<blockquote>
<p>There’s a statistically-significant difference in horsepower for 4- and 6-cylinder cars (<span class="math inline">\(t(11.49) = -3.56\)</span>, <span class="math inline">\(p = 0.004\)</span>).</p>
</blockquote>
<p>To insert these stats inline I wrote e.g. <code>round(ts$parameter, 2)</code> inside an inline code block.<label for="tufte-sn-136" class="margin-toggle sidenote-number">136</label><input type="checkbox" id="tufte-sn-136" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">136</span> APA would require omission of the leading zero. <code>papaja::printp()</code> will let you do that, see below.</span></p>
<p>Note that rounding can occasionally get you in trouble here, because it’s very easy to have an output of <span class="math inline">\(p = 0\)</span> when in fact <span class="math inline">\(p\)</span> can never be exactly equal to 0. Nonetheless, this can help you prevent rounding errors and the wrath of <code>statcheck</code>.</p>
</div>
<div id="exercises-1" class="section level3" number="20.5.5">
<h3><span class="header-section-number">20.5.5</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Using the <code>mtcars</code> dataset, insert a table and a graph of your choice into the document.<label for="tufte-sn-137" class="margin-toggle sidenote-number">137</label><input type="checkbox" id="tufte-sn-137" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">137</span> If you’re feeling uninspired, try <code>hist(mtcars$mpg)</code>.</span></li>
</ol>
</div>
</div>
<div id="collaboration" class="section level2" number="20.6">
<h2><span class="header-section-number">20.6</span> Collaboration</h2>
<p>How do we collaborate using RMarkdown? There are lots of different workflows that people use. The way it works in my lab is that the first author typically makes a github repository with the markdown-formatted document in it. Sometimes we just collaborate through github or through writing comments on the rendered PDF and sending them back to the first author. (I like the dropbox PDF comment interface for this).</p>
<p>But, sometimes you want to do lots of line-editing or write collaboratively, especially with someone who doesn’t like github and markdown and all that. For these cases, we often paste the intro into google docs or Word and edit until we converge, then the first author puts that back into the markdown. This is a little clunky, but not too bad. And critically, all the figures and numbers get rendered fresh when you re-knit, so nothing can get accidentally altered during the editing process.</p>
</div>
<div id="writing-apa-format-papers" class="section level2" number="20.7">
<h2><span class="header-section-number">20.7</span> Writing APA-format papers</h2>
<p>(Thanks to <a href="http://github.com/crsh">Frederick Aust</a> for contributing this section!)</p>
<p>The end-game of reproducible research is to knit your entire paper. We’ll focus on APA-style writeups. Managing APA format is a pain in the best of times. Isn’t it nice to get it done for you?</p>
<p>We’re going to use the <code>papaja</code> package. <code>papaja</code> is a R-package including a R Markdown template that can be used to produce documents that adhere to the American Psychological Association (APA) manuscript guidelines (6th Edition).</p>
<div id="software-requirements" class="section level3" number="20.7.1">
<h3><span class="header-section-number">20.7.1</span> Software requirements</h3>
<p>To use <code>papaja</code>, make sure you are using the latest versions of R and RStudio. If you want to create PDF- in addition to DOCX-files you need <strong><a href="http://de.wikipedia.org/wiki/TeX">TeX</a> 2013 or later</strong>. Try <a href="http://miktex.org/">MikTeX</a> for Windows, <a href="https://tug.org/mactex/">MacTeX</a> for Mac, or <a href="http://www.tug.org/texlive/">TeX Live</a> for Linux. Some Linux users may need a few additional TeX packages for the LaTeX document class <code>apa6</code> to work.<label for="tufte-sn-138" class="margin-toggle sidenote-number">138</label><input type="checkbox" id="tufte-sn-138" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">138</span> For Ubuntu, we suggest running: <code>sudo apt-get install texlive texlive-publishers texlive-fonts-extra texlive-latex-extra texlive-humanities lmodern</code>.</span></p>
</div>
<div id="installing-papaja" class="section level3" number="20.7.2">
<h3><span class="header-section-number">20.7.2</span> Installing <code>papaja</code></h3>
<p><code>papaja</code> has not yet been released on CRAN but you can install it from GitHub.</p>
</div>
<div id="creating-a-document" class="section level3" number="20.7.3">
<h3><span class="header-section-number">20.7.3</span> Creating a document</h3>
<p>The APA manuscript template should now be available through the RStudio menus when creating a new R Markdown file.</p>
<p>When you click RStudio’s <em>Knit</em> button <code>papaja</code>, <code>rmarkdown,</code> and <code>knitr</code> work together to create an APA conform manuscript that includes both your manuscript text and the results of any embedded R code.</p>
<p>Note, if you don’t have TeX installed on your computer, or if you would like to create a Word document replace <code>output: papaja::apa6_pdf</code> with <code>output: papaja::apa6_word</code> in the document YAML header.</p>
<p><code>papaja</code> provides some rendering options that only work if you use <code>output: papaja::apa6_pdf</code>.
<code>figsintext</code> indicates whether figures and tables should be included at the end of the document—as required by APA guidelines—or rendered in the body of the document.
If <code>figurelist</code>, <code>tablelist</code>, or <code>footnotelist</code> are set to <code>yes</code> a list of figure captions, table captions, or footnotes is given following the reference section.
<code>lineno</code> indicates whether lines should be continuously numbered through out the manuscript.</p>
</div>
<div id="bibiographic-management" class="section level3" number="20.7.4">
<h3><span class="header-section-number">20.7.4</span> Bibiographic management</h3>
<p>It’s also possible to include references using <code>bibtex</code>, by using <code>@ref</code> syntax. An option for managing references is <a href="http://bibdesk.sourceforge.net/">bibdesk</a>, which integrates with google scholar.<label for="tufte-sn-139" class="margin-toggle sidenote-number">139</label><input type="checkbox" id="tufte-sn-139" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">139</span> But many other options are possible.</span></p>
<p>With a bibtex file included, you can refer to papers. As an example, <code>@nuijten2016</code> results in the in text citation “<span class="citation"><a href="#ref-nuijten2016" role="doc-biblioref">Michèle B. Nuijten et al.</a> (<a href="#ref-nuijten2016" role="doc-biblioref">2016</a>)</span>,” or cite them parenthetically with <code>[@nuijten2016]</code> <span class="citation">(<a href="#ref-nuijten2016" role="doc-biblioref">Michèle B. Nuijten et al., 2016</a>)</span>. Take a look at the <code>papaja</code> APA example to see how this works.</p>
<p><code>citr</code> is an R package that provides an easy-to-use <a href="https://rstudio.github.io/rstudioaddins/">RStudio addin</a> that facilitates inserting citations.
The addin will automatically look up the Bib(La)TeX-file(s) specified in the YAML front matter.
The references for the inserted citations are automatically added to the documents reference section.</p>
<!-- # ```{r citr-gif, echo = FALSE, fig.align = "center", fig.cap = "Demonstration of the RStudio addin from the `citr` package that inserts R Markdown citations."} -->
<!-- # knitr::include_graphics("figures/addin_demo.gif") -->
<!-- # ``` -->
<p>Once <code>citr</code> is installed (<code>install.packages("citr")</code>) and you have restarted your R session, the addin appears in the menus and you can define a <a href="https://rstudio.github.io/rstudioaddins/#keyboard-shorcuts">keyboard shortcut</a> to call the addin.</p>
</div>
<div id="exercise" class="section level3" number="20.7.5">
<h3><span class="header-section-number">20.7.5</span> Exercise</h3>
<p>Make sure you’ve got <code>papaja</code>, then open a new template file. Compile this document, and look at how awesome it is. (To compile you need <code>texlive</code>, a library for compiling markdown to PDF, so you may need to wait and install this later if it’s not working).</p>
<p>Try pasting in your figure and table from your other RMarkdown (don’t forget any libraries you need to make it compile). Presto, ready to submit!</p>
<p>For a bit more on <code>papaja</code>, check out <strong><a href="https://rpubs.com/YaRrr/papaja_guide">this guide</a></strong>.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-nuijten2016" class="csl-entry">
Nuijten, Michèle B., Hartgerink, C. H. J., Assen, M. A. L. M. van, Epskamp, S., &amp; Wicherts, J. M. (2016). The prevalence of statistical reporting errors in psychology (1985–2013). <em>Behav. Res. Methods</em>, <em>48</em>(4), 1205–1226.
</div>
</div>
<p style="text-align: center;">
<a href="19-github.html"><button class="btn btn-default">Previous</button></a>
<a href="21-tidyverse.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<script src="toc/toc.js"></script>


</body>
</html>
